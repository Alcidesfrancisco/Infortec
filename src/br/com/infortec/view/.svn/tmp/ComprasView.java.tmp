/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * ComprasView.java
 *
 * Created on 22/11/2011, 17:26:06
 */
package br.com.infortec.view;

import br.com.infortec.DAO.ComprasDAO;
import br.com.infortec.DAO.ItensComprasDAO;
import br.com.infortec.DAO.ProdutoDAO;
import br.com.infortec.bean.Compras;
import br.com.infortec.bean.Fornecedor;
import br.com.infortec.bean.ItensCompras;
import br.com.infortec.bean.Produto;
import br.com.infortec.bean.ProdutoCompras;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.sql.Date;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTable;
import javax.swing.RowFilter;
import javax.swing.table.TableModel;
import javax.swing.table.TableRowSorter;

/**
 *
 * @author Israelly
 */
public class ComprasView extends javax.swing.JFrame {

    /** Creates new form ComprasView */
    public ComprasView() {
        initComponents();
    }
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    int cont = 0;
    public static Fornecedor fornecedorImportado = new Fornecedor();
    //public static Produto produtoimportado = new Produto();
    ComprasDAO comprasDAO = new ComprasDAO();
    ItensCompras itensCompra = new ItensCompras();
    private int codCompras;
    static JFrame frame;
    private static ProdutoCompras produtoCompras;
    ItensComprasDAO itensComprasDAO = new ItensComprasDAO();
    List<ItensCompras> ListaEditItensCompras = itensComprasDAO.consultarItensCompras(getCodCompras());
    ProdutoDAO produtoDAO = new ProdutoDAO();
    List<Produto> listaBuscaProduto = produtoDAO.listarTodosProdutos();
    //   ItensCompras itensCompras = new ItensCompras(produto, qtde, vlrUnit, vlrTotal, compras);
    int add = 0;

    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable();
        jFrame1 = new javax.swing.JFrame();
        jScrollPane5 = new javax.swing.JScrollPane();
        jTable4 = new javax.swing.JTable();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        jButton2 = new javax.swing.JButton();
        txtFornecedor = new javax.swing.JTextField();
        jButton3 = new javax.swing.JButton();
        btOk = new javax.swing.JButton();
        painelIntensCompras = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        txtProduto = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        txtValorUnitario = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        table = new javax.swing.JTable(){

            @Override
            public boolean isCellEditable(int row, int col) {
                return false;
            }
        };
        qtdTextField = new javax.swing.JTextField();
        painelTotais = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();
        CustotalTextField = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        valordescTextField1 = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        TotalpgTextField = new javax.swing.JTextField();
        jButton5 = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();
        jButton7 = new javax.swing.JButton();
        jLabel10 = new javax.swing.JLabel();
        jButton8 = new javax.swing.JButton();
        painelprodutos = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        tableProdutos = new javax.swing.JTable(){

            @Override
            public boolean isCellEditable(int row, int col) {
                return false;
            }
        };
        jButton4 = new javax.swing.JButton();
        txtQtdeProduto = new javax.swing.JSpinner();

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane1.setViewportView(jTable1);

        jTable2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane2.setViewportView(jTable2);

        jTable4.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane5.setViewportView(jTable4);

        javax.swing.GroupLayout jFrame1Layout = new javax.swing.GroupLayout(jFrame1.getContentPane());
        jFrame1.getContentPane().setLayout(jFrame1Layout);
        jFrame1Layout.setHorizontalGroup(
            jFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jFrame1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 375, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(15, Short.MAX_VALUE))
        );
        jFrame1Layout.setVerticalGroup(
            jFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jFrame1Layout.createSequentialGroup()
                .addContainerGap(14, Short.MAX_VALUE)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 275, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Compras");

        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel1.setFont(new java.awt.Font("Tahoma", 1, 12));

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel1.setForeground(new java.awt.Color(0, 0, 255));
        jLabel1.setText("Compras");

        jPanel4.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel2.setText("Fornecedor:");

        jButton2.setFont(new java.awt.Font("Tahoma", 1, 12));
        jButton2.setText("Buscar Fornecedor");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

<<<<<<< .mine
        txtFornecedor.setBackground(new java.awt.Color(255, 255, 204));
        txtFornecedor.setEditable(false);
        txtFornecedor.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
=======
        txtFornecedor.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        txtFornecedor.setToolTipText("Informe o nome do fornecedor");
>>>>>>> .r75

        jButton3.setFont(new java.awt.Font("Tahoma", 1, 12));
        jButton3.setText("Cadastrar Novo Fornecedor");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        btOk.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        btOk.setText("Salvar Compra");
        btOk.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btOkActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtFornecedor, javax.swing.GroupLayout.DEFAULT_SIZE, 526, Short.MAX_VALUE)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 104, Short.MAX_VALUE)
                        .addComponent(jButton2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jButton3))
                    .addComponent(btOk, javax.swing.GroupLayout.Alignment.TRAILING))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(jButton3)
                    .addComponent(jButton2))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtFornecedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(8, 8, 8)
                .addComponent(btOk)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(248, 248, 248)
                        .addComponent(jLabel1))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(51, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        painelIntensCompras.setVisible(false);
        painelIntensCompras.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        painelIntensCompras.setFont(new java.awt.Font("Tahoma", 1, 12));

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel8.setText("Qtde:");

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel7.setText("Produto:");

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel6.setForeground(new java.awt.Color(0, 0, 255));
        jLabel6.setText("Ítens Compras");

        txtProduto.setBackground(new java.awt.Color(255, 255, 204));
        txtProduto.setEditable(false);
        txtProduto.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        txtProduto.setToolTipText("Informe o nome do produto");

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel9.setText("Valor unitário:");

        txtValorUnitario.setBackground(new java.awt.Color(255, 255, 204));
        txtValorUnitario.setEditable(false);
<<<<<<< .mine
        txtValorUnitario.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
=======
        txtValorUnitario.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        txtValorUnitario.setToolTipText("Informe o valor unitário");
>>>>>>> .r75

        jButton1.setFont(new java.awt.Font("Tahoma", 1, 12));
        jButton1.setText("Buscar Produto");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        table.setBackground(new java.awt.Color(255, 255, 204));
        table.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        table.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        jScrollPane3.setViewportView(table);

<<<<<<< .mine
        qtdTextField.setBackground(new java.awt.Color(255, 255, 204));
        qtdTextField.setEditable(false);
=======
        qtdTextField.setToolTipText("Informe a quantidade de ítens");
>>>>>>> .r75
        qtdTextField.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                qtdTextFieldFocusLost(evt);
            }
        });

        javax.swing.GroupLayout painelIntensComprasLayout = new javax.swing.GroupLayout(painelIntensCompras);
        painelIntensCompras.setLayout(painelIntensComprasLayout);
        painelIntensComprasLayout.setHorizontalGroup(
            painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelIntensComprasLayout.createSequentialGroup()
                .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(painelIntensComprasLayout.createSequentialGroup()
                        .addGap(216, 216, 216)
                        .addComponent(jLabel6))
                    .addGroup(painelIntensComprasLayout.createSequentialGroup()
                        .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(painelIntensComprasLayout.createSequentialGroup()
                                .addComponent(jLabel7)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jButton1))
                            .addComponent(txtProduto, javax.swing.GroupLayout.PREFERRED_SIZE, 247, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(painelIntensComprasLayout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jLabel8))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, painelIntensComprasLayout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(qtdTextField, javax.swing.GroupLayout.PREFERRED_SIZE, 38, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(14, 14, 14)
                        .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel9)
                            .addComponent(txtValorUnitario, javax.swing.GroupLayout.DEFAULT_SIZE, 99, Short.MAX_VALUE)))
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 404, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );
        painelIntensComprasLayout.setVerticalGroup(
            painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelIntensComprasLayout.createSequentialGroup()
                .addComponent(jLabel6)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(painelIntensComprasLayout.createSequentialGroup()
                        .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel7)
                            .addComponent(jButton1))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtProduto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtValorUnitario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(qtdTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(painelIntensComprasLayout.createSequentialGroup()
                        .addGroup(painelIntensComprasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel9)
                            .addComponent(jLabel8))
                        .addGap(27, 27, 27)))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 158, Short.MAX_VALUE)
                .addContainerGap())
        );

        painelTotais.setVisible(false);
        painelTotais.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel3.setText("Custo Total:");

        CustotalTextField.setBackground(new java.awt.Color(255, 255, 204));
        CustotalTextField.setEditable(false);
        CustotalTextField.setFont(new java.awt.Font("Tahoma", 1, 12));
        CustotalTextField.setText("0");
        CustotalTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CustotalTextFieldActionPerformed(evt);
            }
        });

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel4.setText("Desconto:");

        valordescTextField1.setFont(new java.awt.Font("Tahoma", 1, 12));
        valordescTextField1.setText("0");
        valordescTextField1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                valordescTextField1FocusLost(evt);
            }
        });

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 12));
        jLabel5.setText("Total a Pagar:");

        TotalpgTextField.setBackground(new java.awt.Color(255, 255, 204));
        TotalpgTextField.setEditable(false);
        TotalpgTextField.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        TotalpgTextField.setText("0");
        TotalpgTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TotalpgTextFieldActionPerformed(evt);
            }
        });

        jButton5.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jButton5.setText("Excluir Produto");
        jButton5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton5ActionPerformed(evt);
            }
        });

        jButton6.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jButton6.setText("Imprimir Nota de Compra");

        jButton7.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jButton7.setText("Salvar Compra");
        jButton7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton7ActionPerformed(evt);
            }
        });

        jLabel10.setText("%");

        jButton8.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jButton8.setText("Nova Compra");
        jButton8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton8ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout painelTotaisLayout = new javax.swing.GroupLayout(painelTotais);
        painelTotais.setLayout(painelTotaisLayout);
        painelTotaisLayout.setHorizontalGroup(
            painelTotaisLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelTotaisLayout.createSequentialGroup()
                .addGroup(painelTotaisLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(CustotalTextField, javax.swing.GroupLayout.DEFAULT_SIZE, 97, Short.MAX_VALUE)
                    .addComponent(jLabel3)
                    .addComponent(jLabel4)
                    .addComponent(TotalpgTextField)
                    .addComponent(jLabel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(painelTotaisLayout.createSequentialGroup()
                        .addComponent(valordescTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, 81, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel10)))
                .addContainerGap(90, Short.MAX_VALUE))
            .addComponent(jButton5, javax.swing.GroupLayout.DEFAULT_SIZE, 187, Short.MAX_VALUE)
            .addComponent(jButton6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jButton7, javax.swing.GroupLayout.DEFAULT_SIZE, 187, Short.MAX_VALUE)
            .addComponent(jButton8, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 187, Short.MAX_VALUE)
        );
        painelTotaisLayout.setVerticalGroup(
            painelTotaisLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, painelTotaisLayout.createSequentialGroup()
                .addComponent(jButton5)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton6)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton8)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton7)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 10, Short.MAX_VALUE)
                .addComponent(jLabel3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(CustotalTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel4)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(painelTotaisLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(valordescTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel10))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel5)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(TotalpgTextField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        painelprodutos.setVisible(false);
        painelprodutos.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        tableProdutos.setBackground(new java.awt.Color(255, 255, 204));
        tableProdutos.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        tableProdutos.setModel(tabelaProdutoModel(listaBuscaProduto));
        tableProdutos.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        jScrollPane4.setViewportView(tableProdutos);

        jButton4.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jButton4.setText("Adicionar à Compra");
        jButton4.setToolTipText("Adicionar o produto à compra");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        txtQtdeProduto.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        txtQtdeProduto.setModel(new javax.swing.SpinnerNumberModel(Integer.valueOf(1), Integer.valueOf(1), null, Integer.valueOf(1)));
        txtQtdeProduto.setOpaque(false);

        javax.swing.GroupLayout painelprodutosLayout = new javax.swing.GroupLayout(painelprodutos);
        painelprodutos.setLayout(painelprodutosLayout);
        painelprodutosLayout.setHorizontalGroup(
            painelprodutosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelprodutosLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(painelprodutosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 433, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(painelprodutosLayout.createSequentialGroup()
                        .addComponent(jButton4)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtQtdeProduto, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        painelprodutosLayout.setVerticalGroup(
            painelprodutosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelprodutosLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 353, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 17, Short.MAX_VALUE)
                .addGroup(painelprodutosLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton4)
                    .addComponent(txtQtdeProduto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(painelIntensCompras, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(painelTotais, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(painelprodutos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(painelprodutos, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(painelTotais, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(painelIntensCompras, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void TotalpgTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TotalpgTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_TotalpgTextFieldActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        painelprodutos.setVisible(true);
        ComprasView.this.setSize(1100, 500);

        ////if(produtosComprados.isEmpty()){
////produtosComprados.add(itensCompra);
////}     
//      String [] args = new String[1];
//      args[0] = "Localizar Produtos";
//      BuscaProdutoView.main(args);
//      BuscaProdutoView.setCodCompra(codCompras);

    }//GEN-LAST:event_jButton1ActionPerformed

private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
    String[] titulo = {"Busca de Fornecedores"};
    BuscaFornecedorView.main(titulo);
}//GEN-LAST:event_jButton2ActionPerformed

private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
    String[] titulo = {"Cadastro de Fornecedores"};
    FornecedorView.main(titulo);
    FornecedorView fv = new FornecedorView();

}//GEN-LAST:event_jButton3ActionPerformed
  
private void btOkActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btOkActionPerformed
   
        Compras comprasCab = new Compras(fornecedorImportado);
        setCodCompras(comprasDAO.inserirCompras(comprasCab));
        painelIntensCompras.setVisible(true);
        painelTotais.setVisible(true);
//    table.setModel(tabelaModel(ListaEditItensCompras, codCompras));
        ComprasView.this.setSize(700, 500);
    
}//GEN-LAST:event_btOkActionPerformed
    String QuantidadeDeprodutos;
    Compras compras = comprasDAO.consultarCompras(getCodCompras());
    Produto produto = new Produto();
private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
    produto = listaBuscaProduto.get(tableProdutos.getSelectedRow());
    setTxtProduto(produto.getNome());
    setTxtValorUnitario(produto.getValorCompra());
    qtdTextField.setText(String.valueOf(txtQtdeProduto.getValue()));
    QuantidadeDeprodutos = getTxtQtdeProduto().getValue().toString();
    addProduto();
    CustotalTextField.setText(String.valueOf(calculaTotal()));
}//GEN-LAST:event_jButton4ActionPerformed

private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
    removeProduto(table.getSelectedRow());
    calculaTotal();
}//GEN-LAST:event_jButton5ActionPerformed

private void valordescTextField1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_valordescTextField1FocusLost
    Double totalGeral = totalPagar - (totalPagar * (Double.valueOf(valordescTextField1.getText()) / 100));
    TotalpgTextField.setText(String.valueOf(totalGeral));
}//GEN-LAST:event_valordescTextField1FocusLost

private void CustotalTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CustotalTextFieldActionPerformed
// TODO add your handling code here:
}//GEN-LAST:event_CustotalTextFieldActionPerformed

private void qtdTextFieldFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_qtdTextFieldFocusLost
    table.setValueAt(qtdTextField.getText(), table.getSelectedRow(), 2);
    ListaEditItensCompras.get(table.getSelectedRow()).setQtde((Double.valueOf(qtdTextField.getText())));
    calculaTotal();
    table.setModel(tabelaModel(ListaEditItensCompras, getCodCompras()));
    CustotalTextField.setText(String.valueOf(totalPagar));
}//GEN-LAST:event_qtdTextFieldFocusLost

private void jButton7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton7ActionPerformed
    itensComprasDAO.inserirÌtensCompras(ListaEditItensCompras);
}//GEN-LAST:event_jButton7ActionPerformed

private void jButton8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton8ActionPerformed

   fechar();

}//GEN-LAST:event_jButton8ActionPerformed
    public void addProduto() {
        ItensCompras itensCompras = new ItensCompras(produto, Double.valueOf(QuantidadeDeprodutos), produto.getValorCompra(), produto.getValorCompra() * Double.valueOf(QuantidadeDeprodutos), compras);
        ListaEditItensCompras.add(itensCompras);
        table.setModel(tabelaModel(ListaEditItensCompras, getCodCompras()));
        add++;
    }
    Double totalPagar = 0.0;

    public void removeProduto(int index) {
        ListaEditItensCompras.remove(index);
        table.setModel(tabelaModel(ListaEditItensCompras, getCodCompras()));
        calculaTotal();
        CustotalTextField.setText(String.valueOf(totalPagar));
    }

    public Double calculaTotal() {
        totalPagar = 0.0;

        for (ItensCompras totalItens : ListaEditItensCompras) {
            totalPagar += (totalItens.getVlrTotal());
        }
        return totalPagar;
    }

    public void fechar() {
        this.main(null);
        this.dispose();
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {


        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new ComprasView().setVisible(true);


            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField CustotalTextField;
    private javax.swing.JTextField TotalpgTextField;
    private javax.swing.JButton btOk;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JButton jButton7;
    private javax.swing.JButton jButton8;
    private javax.swing.JFrame jFrame1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JTable jTable1;
    private javax.swing.JTable jTable2;
    private javax.swing.JTable jTable4;
    private javax.swing.JPanel painelIntensCompras;
    private javax.swing.JPanel painelTotais;
    private javax.swing.JPanel painelprodutos;
    private javax.swing.JTextField qtdTextField;
    public javax.swing.JTable table;
    private javax.swing.JTable tableProdutos;
    private static javax.swing.JTextField txtFornecedor;
    private static javax.swing.JTextField txtProduto;
    private javax.swing.JSpinner txtQtdeProduto;
    private javax.swing.JTextField txtValorUnitario;
    private javax.swing.JTextField valordescTextField1;
    // End of variables declaration//GEN-END:variables

    public TableModel tabelaModel(List<ItensCompras> listaItensCompras, int idCompras) {
        int n = 0;
        JTable table1;
        Compras compra = comprasDAO.consultarCompras(idCompras);

        //  listaItensCompras = itensComprasDAO.consultarItensCompras(idCompras);
        Object[][] data = new Object[listaItensCompras.size()][6];
        String[] columnNames = {"Cod da Compra ", "Produto", "Qtde", "valor Unitário", "Valor total"};

        for (ItensCompras itensCompras : listaItensCompras) {
            itensCompras.setCompras(compra);
            data[n][0] = itensCompras.getCompras().getCod();
            data[n][1] = itensCompras.getProduto().getNome();
            data[n][2] = itensCompras.getQtde();
            data[n][3] = itensCompras.getProduto().getValorCompra();
            data[n][4] = itensCompras.getVlrTotal();


            n++;
        }

        table1 = new JTable(data, columnNames);
        table1.setPreferredScrollableViewportSize(new Dimension(500, 300));
        table1.setFillsViewportHeight(true);
        table1.getColumnModel().getColumn(0).setPreferredWidth(70);
        table1.getColumnModel().getColumn(1).setPreferredWidth(400);
        table1.getColumnModel().getColumn(2).setPreferredWidth(100);
        table1.getColumnModel().getColumn(3).setPreferredWidth(100);
        table1.getColumnModel().getColumn(4).setPreferredWidth(100);
        javax.swing.table.TableModel model = table1.getModel();



        table.addMouseListener(new MouseAdapter() {

            public void mouseClicked(MouseEvent e) {
                //
                editarLinha();
                // }
            }
        });
        return model;
    }

    public void editarLinha() {
        int index = table.getSelectedRow();

        txtProduto.setText(String.valueOf(table.getValueAt(table.getSelectedRow(), 1)));
        qtdTextField.setText(String.valueOf(table.getValueAt(table.getSelectedRow(), 2)));
        txtValorUnitario.setText(String.valueOf(table.getValueAt(table.getSelectedRow(), 3)));
    }

    public javax.swing.JTextField getTxtProduto() {
        return txtProduto;
    }

    public static void setTxtProduto(String NomeProduto) {
        txtProduto.setText(NomeProduto);
    }

    public static javax.swing.JTextField getTxtFornecedor() {
        return txtFornecedor;
    }

    public static void setTxtFornecedor(String Nomefornecedor) {
        txtFornecedor.setText(Nomefornecedor);
    }

    public static void setProdutoCompras(ProdutoCompras aProdutoCompras) {
        produtoCompras = aProdutoCompras;
    }

    public static ProdutoCompras getProdutoCompras() {
        return produtoCompras;
    }

    public void setTxtValorUnitario(double valorUnitario) {
        this.txtValorUnitario.setText(String.valueOf(valorUnitario));
    }

    public javax.swing.JSpinner getTxtQtdeProduto() {
        return txtQtdeProduto;
    }

    public void setTxtQtdeProduto(javax.swing.JSpinner txtQtdeProduto) {
        this.txtQtdeProduto = txtQtdeProduto;
    }

    public int getCodCompras() {
        return codCompras;
    }

    public void setCodCompras(int codCompras) {
        this.codCompras = codCompras;
    }
    
    public TableModel tabelaProdutoModel(List<Produto> listaProdutos) {
        int n = 0;
        JTable table1;
        listaProdutos = produtoDAO.listarTodosProdutos();
        Object[][] data = new Object[listaProdutos.size()][10];
        String[] columnNames = {"cod Produto", "Nome", "Descrição", "Valor Compra", "Valor Venda", "Estoque", "Localização", "Fornecedor", "Categoria", "Margem Lucro"};

        for (Produto produtos : listaProdutos) {
            data[n][0] = produtos.getCodProduto();
            data[n][1] = produtos.getNome();
            data[n][2] = produtos.getDescricao();
            data[n][3] = produtos.getValorCompra();
            data[n][4] = produtos.getValorVenda();
            data[n][5] = produtos.getEstoque();
            data[n][6] = produtos.getLocalizacao();
            data[n][7] = produtos.getFornecedor().getNome();
            data[n][8] = produtos.getCategoria().getnomeCategoria();
            data[n][9] = produtos.getMargemLucro();

            n++;
        }

        table1 = new JTable(data, columnNames);
        table1.setPreferredScrollableViewportSize(new Dimension(500, 300));
        table1.setFillsViewportHeight(true);
        table1.getColumnModel().getColumn(0).setPreferredWidth(100);
        table1.getColumnModel().getColumn(1).setPreferredWidth(300);
        table1.getColumnModel().getColumn(2).setPreferredWidth(300);
        javax.swing.table.TableModel model = table1.getModel();



//        table.addMouseListener(new MouseAdapter() {

//            public void mouseClicked(MouseEvent e) {
//                if (cont % 2 == 1) {
//                    editarLinha();
//                }
//            }
//        });
        return model;//adiciona um modela a tabela
    }


}
//    public void editarLinha() {
//        int index = table.getSelectedRow();
//        nomeProdutoField.setText((String) table.getValueAt(table.getSelectedRow(), 1));
//        descricaoProdutoField.setText((String) table.getValueAt(table.getSelectedRow(), 2));
//        valorCompraProdutoField.setText((String) table.getValueAt(table.getSelectedRow(), 3).toString());
//        valorVendaProdutoField.setText(table.getValueAt(table.getSelectedRow(), 4).toString());
//        estoqueField.setText(table.getValueAt(table.getSelectedRow(), 5).toString());
//        localizacaoProdutoField.setText((String) table.getValueAt(table.getSelectedRow(), 6));
//        FornecedorComboBox.setSelectedItem((String) table.getValueAt(table.getSelectedRow(), 7));
//        categoriaComboBox.setSelectedItem((String) table.getValueAt(table.getSelectedRow(), 8));
//        MargemLucroTextField.setText(table.getValueAt(table.getSelectedRow(), 9).toString());
//    }
//}
